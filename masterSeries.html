<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Lemon Legacy Series Banjos</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <div id="header"></div>

  <section class="section">
    <div class="container narrow">
      <h1 class="section-title">Master Series Banjos</h1>
      <p style="text-align:center;">
        The Lemon Master Series is a line of banjos that combine modern innovation with exquisite workmanship and artistry. Some Master Series models are inspired by special people, places, or events, while others are specially designed to suit the needs of a master musician.
      </p>
    </div>
  </section>

  <section class="section">
    <div class="container">
      <div class="card-grid">
        <!-- Bear Fork -->
        <a href="banjo.html?key=MASTER-BEARFORK" class="card-link-wrapper" aria-label="View Bear Fork">
          <article class="card" data-model-key="MASTER-BEARFORK">
            <img loading="lazy" src="assets/product_images/master/bearfork/front.webp" alt="Bear Fork banjo" class="card-img">
            <div class="card-body">
              <h3 class="card-title">Bear Fork</h3>
			  <p class="card-price"></p>
            </div>
          </article>
        </a>
  </section>


  <div id="footer"></div>

<script>
  document.addEventListener('DOMContentLoaded', async () => {
    // --- Tiny GViz helpers just for this page ---
    const SHEET_ID = '1JaKOJLDKDgEvIg54UKKg2J3fftwOsZlKBw1j5qjeheU';

    const GVIZ = (sheet, tq) =>
      'https://corsproxy.io/?' +
      'https://docs.google.com/spreadsheets/d/' + SHEET_ID + '/gviz/tq?' +
      new URLSearchParams({ sheet, tq }).toString();

    const rows = t => (t?.rows || []).map(r => (r.c || []).map(c => c?.v ?? null));

    const fmtUSD = n =>
      new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD' })
        .format(Number(n) || 0);

    // --- Grab all cards that declare a model key ---
    const cards = Array.from(document.querySelectorAll('.card[data-model-key]'));
    if (!cards.length) return;

    const keys = [...new Set(cards.map(c => c.dataset.modelKey.toUpperCase()))];
    const whereClause = keys.map(k => `A='${k}'`).join(' or ');

    try {
      const res = await fetch(
        GVIZ('Products', `select A,D where ${whereClause}`),
        { cache: 'no-store' }
      );
      const txt = await res.text();
      const json = JSON.parse(txt.substring(47).slice(0, -2));
      const table = json.table;
      const data = rows(table);

      const priceByKey = {};
      data.forEach(([key, base]) => {
        if (!key) return;
        priceByKey[String(key).trim().toUpperCase()] = Number(base || 0);
      });

      cards.forEach(card => {
        const key = card.dataset.modelKey.toUpperCase();
        const price = priceByKey[key];
        const el = card.querySelector('.card-price');
        if (!el) return;

        if (price != null) {
          el.textContent = 'Starting at ' + fmtUSD(price);
        } else {
          el.textContent = ''; // or 'Price TBA'
        }
      });
    } catch (err) {
      console.error('Error loading legacy card prices', err);
    }
  });
</script>

  <script>
    Promise.all([
      fetch('header.html').then(r => r.text()).then(h => { document.getElementById('header').innerHTML = h; }),
      fetch('footer.html').then(r => r.text()).then(f => { document.getElementById('footer').innerHTML = f; })
    ]).catch(console.error);
  </script>
</body>
</html>
